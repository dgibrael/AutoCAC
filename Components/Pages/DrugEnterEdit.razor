@page "/drugenteredit"
@inject IJSRuntime JSRuntime
@inject NavigationManager NavigationManager
@inject DialogService DialogService
@inject ContextMenuService ContextMenuService
@inject TooltipService TooltipService
@inject NotificationService NotificationService
@inject IDbContextFactory<mainContext> DbFactory
@using AutoCAC.Components.Templates
@using AutoCAC.Models
@using Microsoft.EntityFrameworkCore

<PageTitle>Drug Enter Edit</PageTitle>

<RPMSOutput />
<NdfLookup SelectionChanged="OnNdfSelected" />

@code {
    [CascadingParameter(Name = "MainLayout")] public MainLayout mainLayout { get; set; }
    private MainLayout Layout => mainLayout ?? new MainLayout();

    private string ndcInput = string.Empty;
    private List<VwNdcLookup>? lookupResults;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            if (!Layout.RPMS.IsConnected) return;
            try
            {
                Layout.RPMS.Menu();
            }
            catch (Exception ex)
            {
                Layout!.ShowError(ex.Message);
            }
            await InvokeAsync(StateHasChanged);
        }
    }

    private Ndf selectedNdf;

    private Task OnNdfSelected(Ndf selected)
    {
        selectedNdf = selected;

        return Task.CompletedTask;
    }
}

